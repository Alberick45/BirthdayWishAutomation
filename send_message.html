<!DOCTYPE html>
<html>
<head>
    <title>Manage Messages</title>
    <script>
        
        function loadOptions() {
            // Load options for the "Contacts" dropdown
            var cont = new XMLHttpRequest();
            cont.open('GET', 'php/view_contact.php', true);
            cont.send();
            cont.onload = function() {
                if (cont.status === 200) {
                    document.getElementById('contacts').innerHTML = cont.response;
                } else {
                    alert(`Error ${cont.status}: ${cont.statusText}`);
                }
            };
            cont.onerror = function() {
                alert("Request failed");
            };

            // Load options for the "Custom Messages" dropdown
            var cm = new XMLHttpRequest();
            cm.open('GET', 'php/custom_messages.php', true);
            cm.send();
            cm.onload = function() {
                if (cm.status === 200) {
                    document.getElementById('custom').innerHTML = cm.response;
                } else {
                    alert(`Error ${cm.status}: ${cm.statusText}`);
                }
            };
            cm.onerror = function() {
                alert("Request failed");
            };

            // Load options for the "Sample Messages" dropdown
            var sm = new XMLHttpRequest();
            sm.open('GET', 'php/sample_messages.php', true);
            sm.send();
            sm.onload = function() {
                if (sm.status === 200) {
                    document.getElementById('sample').innerHTML = sm.response;
                } else {
                    alert(`Error ${sm.status}: ${sm.statusText}`);
                }
            };
            sm.onerror = function() {
                alert("Request failed");
            };
        }

        function toggleMessageInput(select) {
            var addMessageInput = document.getElementById('addMessageInput');
            addMessageInput.style.display = (select.value === 'add_new') ? 'block' : 'none';
        }

        document.addEventListener('DOMContentLoaded', loadOptions);

        window.onload =automate_birthday;
    </script>
</head>
<body>
    <h1>Manage Messages</h1>
    
    <!-- Unified Form -->
    <form id="messageForm" action="php/process_messages.php" method="post">
        <label for="">Choose from either sample messages or custom. If choosing from sample, make sure custom shows none.</label>

        <!-- Contacts -->
        <div>
            <label for="contacts">
                Contacts:
                <select name="select_contacts" id="contacts">
                    <!-- Options loaded dynamically -->
                </select>
            </label>
        </div>

        <!-- Sample Messages -->
        <div>
            <label for="sm_message">
                Sample Messages:
                <select name="select_msg" id="sample">
                    <!-- Options loaded dynamically -->
                </select>
            </label>
        </div>

        <!-- Custom Messages -->
        <div>
            <label for="cm_message">
                Custom Messages:
                <select name="select_msg2" id="custom" onchange="toggleMessageInput(this)">
                    <!-- Options loaded dynamically -->
                    <option value="add_new">Add new message</option>
                </select>
            </label>
            <div id="addMessageInput" style="display:none;">
                <textarea name="new_message" placeholder="Enter your new message here..."></textarea>
            </div>
        </div>

        <!-- Single Submit Button -->
        <div>
            <input type="submit" value="Submit">
        </div>
    </form>
</body>
</html>
